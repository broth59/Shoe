<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="myPage">
	<select id="regAddrTotal" resultType="int">
		select count(*) from delivinfo
	</select>
	
	<insert id="insertAddr" parameterType="RegAddr">
		insert into delivinfo 
		(delivno, delivname, delivperson, phone1,phone2,post
		,address1,address2,userid) 
		values (delivno_seq.nextval,#{delivname},#{delivperson},#{phone1},#{phone2},
		#{post},#{address1},#{address2},#{userid})
	</insert>
	
	<select id="getAddrList" parameterType="string" resultType="RegAddr">
		select * from delivinfo
		where userid = #{userid}
		order by delivno
	</select>
	
	<select id="searchByNo" parameterType="string" resultType="RegAddr">
		select delivno, delivname, delivperson, phone1, phone2,
		post, address1, address2, userid
		from delivinfo
		where delivno=#{delivno}
	</select>
	
	<insert id="modifyAddr" parameterType="RegAddr">
		update delivinfo set delivname=#{delivname}, delivperson=#{delivperson},
		phone1 = #{phone1}, phone2 = #{phone2}, address1 = #{address1}, address2 = #{address2}
		where delivno = #{delivno}
	</insert>
	
	<delete id="deleteDelivnos" parameterType="list">
		delete from delivinfo 
		where delivno in 
		<foreach collection="list" index="index" item="item" open="(" separator="," close=")">
			#{item}
		</foreach>
	</delete>
	
	<select id="searchPwdById" parameterType="hashmap" resultType="int">
		select count(*) from account
		where userid = #{userid}
		and passwd = #{password}
	</select>
	
	<select id="searchMemberById" resultType="MemberDTO">
		select * from account where userid = #{userid}
	</select>
	
	<update id="modifyAccountInfo" parameterType="hashmap">
		update account set phone1=#{phone1}, phone2=#{phone2}, phone3=#{phone3},
		email1=#{email1}, email2=#{email2}, addr1=#{addr1},addr2=#{addr2},addr3=#{addr3}
		where userid = #{userid}
	</update>
	
	<select id="getOrderList" parameterType="hashmap" resultType="OrderDTO">
		select * from ordertable where userid=#{userid}
		and
		<if test="start==null">
			order_date=#{end}
		</if>
		<if test="start!=null">
			order_date between #{start} and #{end}
		</if>
		order by order_date desc
	</select>
</mapper>